!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n={};function i(e){return s(e)||u(e)||a(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function u(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function s(e){if(Array.isArray(e))return l(e)}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e,t,r){var n=t.get(e);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(e,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}function p(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}r.r(n),r.d(n,"getDifference",(function(){return L})),r.d(n,"waitSomeTime",(function(){return T})),r.d(n,"initSharedGrid",(function(){return j})),r.d(n,"calcNextState",(function(){return O}));var v=function(){function e(){f(this,e),g.set(this,{writable:!0,value:void 0}),b.set(this,{writable:!0,value:void 0}),m.set(this,{writable:!0,value:void 0}),w.set(this,{writable:!0,value:void 0}),A.set(this,{writable:!0,value:void 0})}return d(e,[{key:"initSharedGrid",value:function(e,t,r,n,i){if(!(e instanceof SharedArrayBuffer&&t instanceof SharedArrayBuffer&&r instanceof SharedArrayBuffer))throw new TypeError("SharedGrid.constructor requires instance of SharedArrayBuffer as first, second and third argument");y(this,w,n),y(this,A,i),y(this,g,new Int8Array(e)),y(this,b,new Int8Array(t)),y(this,m,new Int8Array(r))}},{key:"gridToWrite",value:function(){return Atomics.load(p(this,m),0)?p(this,b):p(this,g)}},{key:"gridToDisplay",value:function(){return Atomics.load(p(this,m),0)?p(this,g):p(this,b)}},{key:"clearGrid",value:function(t){for(var r=0;r<p(this,w);r++)for(var n=0;n<p(this,A);n++)this.setCell(t,r,n,e.DEAD_CELL)}},{key:"getCell",value:function(e,t,r){if(!(e instanceof Int8Array))throw new TypeError("SharedGrid.getCell requires Int8Array as first argument");var n=t>=p(this,w)?0:t<0?p(this,w)-1:t,i=r>=p(this,A)?0:r<0?p(this,A)-1:r;return Atomics.load(e,n*p(this,A)+i)}},{key:"setCell",value:function(e,t,r,n){if(!(e instanceof Int8Array))throw new TypeError("SharedGrid.getCell requires Int8Array as first argument");Atomics.exchange(e,t*p(this,A)+r,n)}},{key:"getCoords",value:function(e){if(e<p(this,A)*p(this,w)){var t=Math.floor(e/p(this,A));return[t,e-t*p(this,A)]}return[0,0]}},{key:"getArrayCell",value:function(e,t){return this.getCell.apply(this,[e].concat(i(this.getCoords(t))))}},{key:"setArrayCell",value:function(e,t,r){this.setCell.apply(this,[e].concat(i(this.getCoords(t)),[r]))}},{key:"getNeighbors",value:function(e,t){for(var r=[],n=-1;n<2;n++)for(var i=-1;i<2;i++)r.push(this.getCell(this.gridToDisplay(),e+n,t+i));return r}},{key:"setNextArrayCellState",value:function(e){this.setNextCellState.apply(this,i(this.getCoords(e)))}},{key:"setNextCellState",value:function(t,r){var n=this.getCell(this.gridToDisplay(),t,r),i=this.getNeighbors(t,r),o=0;i.forEach((function(t){t===e.ALIVE_CELL&&o++}));var a=3===o||n===e.ALIVE_CELL&&2===o?e.ALIVE_CELL:e.DEAD_CELL;this.setCell(this.gridToWrite(),t,r,a)}},{key:"height",get:function(){return p(this,w)}},{key:"width",get:function(){return p(this,A)}}]),e}(),g=new WeakMap,b=new WeakMap,m=new WeakMap,w=new WeakMap,A=new WeakMap;h(v,"DEAD_CELL",0),h(v,"ALIVE_CELL",1);var S=arguments;function C(e){throw new Error('"'+e+'" is read-only')}var E=new v,k=function(e){if(S.length<1)throw new TypeError("reply - takes at least one argument");for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];self.postMessage({queryMethodListener:e,queryMethodArguments:r})},L=function(e,t){k("printStuff",e-t)},T=function(){setTimeout((function(){k("doAlert",3,"seconds")}),3e3)},j=function(e,t,r,n,i){E.initSharedGrid(e,t,r,n,i),k("printStuff","Shared Grid init done")},O=function(e,t,r){C("sharedGrid"),E=new v(e,t,r)};function I(e){return D(e)||x(e)||_(e)||M()}function M(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _(e,t){if(e){if("string"==typeof e)return q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?q(e,t):void 0}}function x(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function D(e){if(Array.isArray(e))return q(e)}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var G=function(e){console.log(e)};self.onmessage=function(e){if(e.data instanceof Object&&e.data.hasOwnProperty("queryMethod")&&e.data.hasOwnProperty("queryArguments")){var t=e.data,r=t.queryMethod,i=t.queryArguments;n[r]&&n[r].apply(n,I(i))}else G(e.data)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vZHVsZXMvU2hhcmVkR3JpZC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvd29ya2Vycy93b3JrZXJVdGlsLmpzIiwid2VicGFjazovLy8uL3NyYy93b3JrZXJzL3dvcmtlci5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIlNoYXJlZEdyaWQiLCJzaGFyZWRBcnJheUJ1ZmZlciIsInNoYXJlZEFycmF5QnVmZmVyVG1wIiwic2hhcmVkRGlzcGxheUZsYWciLCJoZWlnaHQiLCJ3aWR0aCIsIlNoYXJlZEFycmF5QnVmZmVyIiwiVHlwZUVycm9yIiwidGhpcyIsIkludDhBcnJheSIsIkF0b21pY3MiLCJsb2FkIiwiZ3JpZCIsImoiLCJzZXRDZWxsIiwiREVBRF9DRUxMIiwiZXhjaGFuZ2UiLCJ4IiwiTWF0aCIsImZsb29yIiwiZ2V0Q2VsbCIsImdldENvb3JkcyIsIm5laWdoYm9ycyIsImEiLCJiIiwicHVzaCIsImdyaWRUb0Rpc3BsYXkiLCJzZXROZXh0Q2VsbFN0YXRlIiwiY2VsbCIsImdldE5laWdoYm9ycyIsImFsaXZlIiwiZm9yRWFjaCIsIkFMSVZFX0NFTEwiLCJncmlkVG9Xcml0ZSIsInNoYXJlZEdyaWQiLCJyZXBseSIsInF1ZXJ5TWV0aG9kTGlzdGVuZXIiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJxdWVyeU1ldGhvZEFyZ3VtZW50cyIsInNlbGYiLCJwb3N0TWVzc2FnZSIsImdldERpZmZlcmVuY2UiLCJ3YWl0U29tZVRpbWUiLCJzZXRUaW1lb3V0IiwiaW5pdFNoYXJlZEdyaWQiLCJjYWxjTmV4dFN0YXRlIiwiZGVmYXVsdFJlcGx5IiwibWVzc2FnZSIsImNvbnNvbGUiLCJldmVudCIsInF1ZXJ5TWV0aG9kIiwicXVlcnlBcmd1bWVudHMiLCJ3b3JrZXJNZXRob2RzIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdB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YUFBY1osRUFBSUMsSUFHYm1CLEVBQWUsV0FDMUJDLFlBQVcsV0FDVFQsRUFBTSxVQUFXLEVBQUcsYUFDbkIsTUFHUVUsRUFBaUIsU0FDNUI1QyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUVBNkIsRUFBV1csZUFDVDVDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBRUY4QixFQUFNLGFBQWMsMEJBR1RXLEVBQWdCLFNBQUM3QyxFQUFtQkcsRUFBUUMsR0FDN0MsZ0JBQVY2QixFQUFhLElBQUlsQyxFQUFXQyxFQUFtQkcsRUFBUUMsSSx5dUJDeEN6RCxJQUFNMEMsRUFBZSxTQUFDQyxHQUNwQkMsZ0JBR0ZULGVBQWlCLFlBQ2YsR0FDRVUsMEJBQ0FBLHNCQURBQSxnQkFFQUEsc0JBSEYsa0JBSUUsT0FDd0NBLEVBRHhDLEtBQ1FDLEVBRFIsY0FDcUJDLEVBRHJCLGlCQUVBQyxNQUE4QkEsYUFBYSxFQUEzQ0EsU0FFQU4sRUFBYUcsRUFBYkgiLCJmaWxlIjoiMC5pbmRleC53b3JrZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTaGFyZWRHcmlkIHtcbiAgc3RhdGljIERFQURfQ0VMTCA9IDA7XG4gIHN0YXRpYyBBTElWRV9DRUxMID0gMTtcblxuICAvLyBzaGFyZWQgYXJyYXlzXG4gICNncmlkO1xuICAjZ3JpZFRtcDtcbiAgI2lzR3JpZERpc3BsYXllZDtcblxuICAjaGVpZ2h0O1xuICAjd2lkdGg7XG5cbiAgZ2V0IGhlaWdodCgpIHtcbiAgICByZXR1cm4gdGhpcy4jaGVpZ2h0O1xuICB9XG5cbiAgZ2V0IHdpZHRoKCkge1xuICAgIHJldHVybiB0aGlzLiN3aWR0aDtcbiAgfVxuXG4gIGluaXRTaGFyZWRHcmlkKFxuICAgIHNoYXJlZEFycmF5QnVmZmVyLFxuICAgIHNoYXJlZEFycmF5QnVmZmVyVG1wLFxuICAgIHNoYXJlZERpc3BsYXlGbGFnLFxuICAgIGhlaWdodCxcbiAgICB3aWR0aFxuICApIHtcbiAgICBpZiAoXG4gICAgICAhKFxuICAgICAgICBzaGFyZWRBcnJheUJ1ZmZlciBpbnN0YW5jZW9mIFNoYXJlZEFycmF5QnVmZmVyICYmXG4gICAgICAgIHNoYXJlZEFycmF5QnVmZmVyVG1wIGluc3RhbmNlb2YgU2hhcmVkQXJyYXlCdWZmZXIgJiZcbiAgICAgICAgc2hhcmVkRGlzcGxheUZsYWcgaW5zdGFuY2VvZiBTaGFyZWRBcnJheUJ1ZmZlclxuICAgICAgKVxuICAgIClcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgIFwiU2hhcmVkR3JpZC5jb25zdHJ1Y3RvciByZXF1aXJlcyBpbnN0YW5jZSBvZiBTaGFyZWRBcnJheUJ1ZmZlciBhcyBmaXJzdCwgc2Vjb25kIGFuZCB0aGlyZCBhcmd1bWVudFwiXG4gICAgICApO1xuICAgIHRoaXMuI2hlaWdodCA9IGhlaWdodDtcbiAgICB0aGlzLiN3aWR0aCA9IHdpZHRoO1xuICAgIHRoaXMuI2dyaWQgPSBuZXcgSW50OEFycmF5KHNoYXJlZEFycmF5QnVmZmVyKTtcbiAgICB0aGlzLiNncmlkVG1wID0gbmV3IEludDhBcnJheShzaGFyZWRBcnJheUJ1ZmZlclRtcCk7XG4gICAgdGhpcy4jaXNHcmlkRGlzcGxheWVkID0gbmV3IEludDhBcnJheShzaGFyZWREaXNwbGF5RmxhZyk7XG4gIH1cblxuICBncmlkVG9Xcml0ZSgpIHtcbiAgICByZXR1cm4gISFBdG9taWNzLmxvYWQodGhpcy4jaXNHcmlkRGlzcGxheWVkLCAwKVxuICAgICAgPyB0aGlzLiNncmlkVG1wXG4gICAgICA6IHRoaXMuI2dyaWQ7XG4gIH1cblxuICBncmlkVG9EaXNwbGF5KCkge1xuICAgIHJldHVybiAhIUF0b21pY3MubG9hZCh0aGlzLiNpc0dyaWREaXNwbGF5ZWQsIDApXG4gICAgICA/IHRoaXMuI2dyaWRcbiAgICAgIDogdGhpcy4jZ3JpZFRtcDtcbiAgfVxuXG4gIGNsZWFyR3JpZChncmlkKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLiNoZWlnaHQ7IGkrKylcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy4jd2lkdGg7IGorKylcbiAgICAgICAgdGhpcy5zZXRDZWxsKGdyaWQsIGksIGosIFNoYXJlZEdyaWQuREVBRF9DRUxMKTtcbiAgfVxuXG4gIGdldENlbGwoZ3JpZCwgaSwgaikge1xuICAgIGlmICghKGdyaWQgaW5zdGFuY2VvZiBJbnQ4QXJyYXkpKVxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgXCJTaGFyZWRHcmlkLmdldENlbGwgcmVxdWlyZXMgSW50OEFycmF5IGFzIGZpcnN0IGFyZ3VtZW50XCJcbiAgICAgICk7XG4gICAgY29uc3QgbSA9IGkgPj0gdGhpcy4jaGVpZ2h0ID8gMCA6IGkgPCAwID8gdGhpcy4jaGVpZ2h0IC0gMSA6IGk7XG4gICAgY29uc3QgbiA9IGogPj0gdGhpcy4jd2lkdGggPyAwIDogaiA8IDAgPyB0aGlzLiN3aWR0aCAtIDEgOiBqO1xuICAgIHJldHVybiBBdG9taWNzLmxvYWQoZ3JpZCwgbSAqIHRoaXMuI3dpZHRoICsgbik7XG4gIH1cblxuICBzZXRDZWxsKGdyaWQsIGksIGosIHZhbHVlKSB7XG4gICAgaWYgKCEoZ3JpZCBpbnN0YW5jZW9mIEludDhBcnJheSkpXG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICBcIlNoYXJlZEdyaWQuZ2V0Q2VsbCByZXF1aXJlcyBJbnQ4QXJyYXkgYXMgZmlyc3QgYXJndW1lbnRcIlxuICAgICAgKTtcbiAgICBBdG9taWNzLmV4Y2hhbmdlKGdyaWQsIGkgKiB0aGlzLiN3aWR0aCArIGosIHZhbHVlKTtcbiAgfVxuXG4gIGdldENvb3Jkcyh4KSB7XG4gICAgaWYgKHggPCB0aGlzLiN3aWR0aCAqIHRoaXMuI2hlaWdodCkge1xuICAgICAgbGV0IGkgPSBNYXRoLmZsb29yKHggLyB0aGlzLiN3aWR0aCk7XG4gICAgICBsZXQgaiA9IHggLSBpICogdGhpcy4jd2lkdGg7XG4gICAgICByZXR1cm4gW2ksIGpdO1xuICAgIH1cbiAgICByZXR1cm4gWzAsIDBdO1xuICB9XG5cbiAgZ2V0QXJyYXlDZWxsKGdyaWQsIHgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRDZWxsKGdyaWQsIC4uLnRoaXMuZ2V0Q29vcmRzKHgpKTtcbiAgfVxuXG4gIHNldEFycmF5Q2VsbChncmlkLCB4LCB2YWx1ZSkge1xuICAgIHRoaXMuc2V0Q2VsbChncmlkLCAuLi50aGlzLmdldENvb3Jkcyh4KSwgdmFsdWUpO1xuICB9XG5cbiAgZ2V0TmVpZ2hib3JzKGksIGopIHtcbiAgICBjb25zdCBuZWlnaGJvcnMgPSBbXTtcbiAgICBmb3IgKGxldCBhID0gLTE7IGEgPCAyOyBhKyspXG4gICAgICBmb3IgKGxldCBiID0gLTE7IGIgPCAyOyBiKyspXG4gICAgICAgIG5laWdoYm9ycy5wdXNoKHRoaXMuZ2V0Q2VsbCh0aGlzLmdyaWRUb0Rpc3BsYXkoKSwgaSArIGEsIGogKyBiKSk7XG4gICAgcmV0dXJuIG5laWdoYm9ycztcbiAgfVxuXG4gIHNldE5leHRBcnJheUNlbGxTdGF0ZSh4KSB7XG4gICAgdGhpcy5zZXROZXh0Q2VsbFN0YXRlKC4uLnRoaXMuZ2V0Q29vcmRzKHgpKTtcbiAgfVxuXG4gIHNldE5leHRDZWxsU3RhdGUoaSwgaikge1xuICAgIGNvbnN0IGNlbGwgPSB0aGlzLmdldENlbGwodGhpcy5ncmlkVG9EaXNwbGF5KCksIGksIGopO1xuICAgIGNvbnN0IG5laWdoYm9ycyA9IHRoaXMuZ2V0TmVpZ2hib3JzKGksIGopO1xuICAgIGxldCBhbGl2ZSA9IDA7XG5cbiAgICBuZWlnaGJvcnMuZm9yRWFjaCgoYykgPT4ge1xuICAgICAgaWYgKGMgPT09IFNoYXJlZEdyaWQuQUxJVkVfQ0VMTCkgYWxpdmUrKztcbiAgICB9KTtcblxuICAgIGNvbnN0IHZhbHVlID1cbiAgICAgIGFsaXZlID09PSAzXG4gICAgICAgID8gU2hhcmVkR3JpZC5BTElWRV9DRUxMXG4gICAgICAgIDogY2VsbCA9PT0gU2hhcmVkR3JpZC5BTElWRV9DRUxMICYmIGFsaXZlID09PSAyXG4gICAgICAgID8gU2hhcmVkR3JpZC5BTElWRV9DRUxMXG4gICAgICAgIDogU2hhcmVkR3JpZC5ERUFEX0NFTEw7XG5cbiAgICB0aGlzLnNldENlbGwodGhpcy5ncmlkVG9Xcml0ZSgpLCBpLCBqLCB2YWx1ZSk7XG4gIH1cbn1cbiIsImltcG9ydCBTaGFyZWRHcmlkIGZyb20gXCJtb2R1bGVzL1NoYXJlZEdyaWRcIjtcblxuY29uc3Qgc2hhcmVkR3JpZCA9IG5ldyBTaGFyZWRHcmlkKCk7XG5cbmNvbnN0IHJlcGx5ID0gKHF1ZXJ5TWV0aG9kTGlzdGVuZXIsIC4uLnF1ZXJ5TWV0aG9kQXJndW1lbnRzKSA9PiB7XG4gIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwicmVwbHkgLSB0YWtlcyBhdCBsZWFzdCBvbmUgYXJndW1lbnRcIik7XG5cbiAgc2VsZi5wb3N0TWVzc2FnZSh7XG4gICAgcXVlcnlNZXRob2RMaXN0ZW5lcixcbiAgICBxdWVyeU1ldGhvZEFyZ3VtZW50cyxcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RGlmZmVyZW5jZSA9IChhLCBiKSA9PiB7XG4gIHJlcGx5KFwicHJpbnRTdHVmZlwiLCBhIC0gYik7XG59O1xuXG5leHBvcnQgY29uc3Qgd2FpdFNvbWVUaW1lID0gKCkgPT4ge1xuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICByZXBseShcImRvQWxlcnRcIiwgMywgXCJzZWNvbmRzXCIpO1xuICB9LCAzMDAwKTtcbn07XG5cbmV4cG9ydCBjb25zdCBpbml0U2hhcmVkR3JpZCA9IChcbiAgc2hhcmVkQXJyYXlCdWZmZXIsXG4gIHNoYXJlZEFycmF5QnVmZmVyVG1wLFxuICBzaGFyZWREaXNwbGF5RmxhZyxcbiAgaGVpZ2h0LFxuICB3aWR0aFxuKSA9PiB7XG4gIHNoYXJlZEdyaWQuaW5pdFNoYXJlZEdyaWQoXG4gICAgc2hhcmVkQXJyYXlCdWZmZXIsXG4gICAgc2hhcmVkQXJyYXlCdWZmZXJUbXAsXG4gICAgc2hhcmVkRGlzcGxheUZsYWcsXG4gICAgaGVpZ2h0LFxuICAgIHdpZHRoXG4gICk7XG4gIHJlcGx5KFwicHJpbnRTdHVmZlwiLCBcIlNoYXJlZCBHcmlkIGluaXQgZG9uZVwiKTtcbn07XG5cbmV4cG9ydCBjb25zdCBjYWxjTmV4dFN0YXRlID0gKHNoYXJlZEFycmF5QnVmZmVyLCBoZWlnaHQsIHdpZHRoKSA9PiB7XG4gIHNoYXJlZEdyaWQgPSBuZXcgU2hhcmVkR3JpZChzaGFyZWRBcnJheUJ1ZmZlciwgaGVpZ2h0LCB3aWR0aCk7XG59O1xuIiwiaW1wb3J0ICogYXMgd29ya2VyTWV0aG9kcyBmcm9tIFwiLi93b3JrZXJVdGlsXCI7XG5cbmNvbnN0IGRlZmF1bHRSZXBseSA9IChtZXNzYWdlKSA9PiB7XG4gIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xufTtcblxuc2VsZi5vbm1lc3NhZ2UgPSAoZXZlbnQpID0+IHtcbiAgaWYgKFxuICAgIGV2ZW50LmRhdGEgaW5zdGFuY2VvZiBPYmplY3QgJiZcbiAgICBldmVudC5kYXRhLmhhc093blByb3BlcnR5KFwicXVlcnlNZXRob2RcIikgJiZcbiAgICBldmVudC5kYXRhLmhhc093blByb3BlcnR5KFwicXVlcnlBcmd1bWVudHNcIilcbiAgKSB7XG4gICAgY29uc3QgeyBxdWVyeU1ldGhvZCwgcXVlcnlBcmd1bWVudHMgfSA9IGV2ZW50LmRhdGE7XG4gICAgd29ya2VyTWV0aG9kc1txdWVyeU1ldGhvZF0gJiYgd29ya2VyTWV0aG9kc1txdWVyeU1ldGhvZF0oLi4ucXVlcnlBcmd1bWVudHMpO1xuICB9IGVsc2Uge1xuICAgIGRlZmF1bHRSZXBseShldmVudC5kYXRhKTtcbiAgfVxufTtcbiJdLCJzb3VyY2VSb290IjoiIn0=